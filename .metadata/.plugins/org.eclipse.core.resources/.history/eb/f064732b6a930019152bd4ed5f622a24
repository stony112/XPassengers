<%@tag description="Overall Page template" pageEncoding="UTF-8"%>
<%@ tag import="java.sql.*" %>
<jsp:useBean id="utils" class="XPassengersWeb.XPassengersUtils"/>
<jsp:useBean id="dao" class="XPassengersWeb.databaseAccess"/>
<form method="post" action="/AircraftServlet">
<%
	ResultSet airplanes = dao.getResults("airplanes");
	ResultSet boughtAirplanes = dao.getAirlinesAirplanesData("*", utils.getActiveAirline());
	
	while (airplanes.next()) {
		while (boughtAirplanes.next()) {
			double price;
			if (boughtAirplanes.getInt("airplaneid") == airplanes.getInt("id")) {
				price = utils.getSellingPrice(boughtAirplanes.getInt("quality"), boughtAirplanes.getInt("flighthours"), airplanes.getFloat("price"));
			} else {
				price = airplanes.getDouble("price");
			}
			%> 
			<div class="xp_aircraftSnippet">
				<div class="xp_aircraftInfoWrapper">
					<h4><%= airplanes.getString("name") %></h4>
					<div class="xp_aircraftInfo">
						<div>
							<span class="xp_aircraftInfoName">Empty-Weight:</span><span class="xp_aircraftInfoValue"><%= airplanes.getDouble("emptyweight") %></span>
						</div>
						<div>
							<span class="xp_aircraftInfoName">Take-Off-Weight:</span><span class="xp_aircraftInfoValue"><%= airplanes.getDouble("toweight") %></span>
						</div>
						<div>
							<span class="xp_aircraftInfoName">Fuel-Weight:</span><span class="xp_aircraftInfoValue"><%= airplanes.getDouble("fuel") %></span>
						</div>
						<div>
							<span class="xp_aircraftInfoName">Fuel-Type:</span><span class="xp_aircraftInfoValue"><%= airplanes.getString("fuelType") %></span>
						</div>
						<div>
							<span class="xp_aircraftInfoName">Seats:</span><span class="xp_aircraftInfoValue"><%= airplanes.getDouble("seats") %></span>
						</div>
						<div>
							<span class="xp_aircraftInfoName">Price:</span><span class="xp_aircraftInfoValue"><%= utils.doubleToPrice(price) %> â‚¬</span>
						</div>
					</div>
				</div>
				<%
				if (boughtAirplanes.getInt("airplaneid") == airplanes.getInt("id")) {
				%> 
					<button type="submit" name="sell" value="sell<%= airplanes.getInt("id") %>">sell</button>
				<%
				} else {
				%> 
					<button type="submit" name="buy" value="buy<%= airplanes.getInt("id") %>">buy</button>
				<%
				}
				%> 
			</div>
			<%
		}
	}
%>
</form>